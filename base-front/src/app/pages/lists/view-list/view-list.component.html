<div class="container mt-5">
  <h2>👥 Personnes de la liste</h2>

  <div *ngIf="loading" class="text-center">
    <div class="spinner-border text-primary" role="status"></div>
  </div>

  <div *ngIf="!loading && persons.length === 0" class="alert alert-info">
    Aucune personne dans cette liste.
  </div>

  <table *ngIf="!loading && persons.length > 0" class="table table-striped mt-3">
    <thead>
      <tr>
        <th>Nom</th><th>Genre</th><th>Âge</th><th>Français</th><th>Tech</th><th>DWWM</th><th>Profil</th><th></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let p of persons">
        <td>{{ p.name }}</td>
        <td>{{ p.gender }}</td>
        <td>{{ p.age }}</td>
        <td>{{ p.frenchLevel }}</td>
        <td>{{ p.techLevel }}</td>
        <td>{{ p.oldDwwm ? '✅' : '❌' }}</td>
        <td>{{ p.profile }}</td>
        <td>
          <button class="btn btn-sm btn-danger" (click)="deletePerson(p.id)">🗑️</button>
        </td>
      </tr>
    </tbody>
  </table>

  <hr class="my-4" />

  <h4>➕ Ajouter une personne</h4>

  <form [formGroup]="personForm" (ngSubmit)="addPerson()" class="row g-3">
    <div class="col-md-4">
      <input type="text" formControlName="name" class="form-control" placeholder="Nom" />
    </div>
    <div class="col-md-2">
      <select formControlName="gender" class="form-select">
        <option value="MALE">Homme</option>
        <option value="FEMALE">Femme</option>
        <option value="UNDISCLOSED">?</option>
      </select>
    </div>
    <div class="col-md-2">
      <input type="number" formControlName="age" class="form-control" placeholder="Âge" />
    </div>
    <div class="col-md-2">
      <input type="number" formControlName="frenchLevel" class="form-control" placeholder="Français (1–4)" />
    </div>
    <div class="col-md-2">
      <input type="number" formControlName="techLevel" class="form-control" placeholder="Tech (1–4)" />
    </div>
    <div class="col-md-3">
      <select formControlName="profile" class="form-select">
        <option value="TIMIDE">Timide</option>
        <option value="RESERVE">Réservé</option>
        <option value="A_LAISE">À l’aise</option>
      </select>
    </div>
    <div class="col-md-2 d-flex align-items-center">
      <label class="form-check-label me-2">Ancien DWWM</label>
      <input type="checkbox" formControlName="oldDwwm" class="form-check-input" />
    </div>
    <div class="col-md-12">
      <button class="btn btn-primary" type="submit" [disabled]="personForm.invalid">Ajouter</button>
    </div>
  </form>

  <div *ngIf="message" class="alert alert-success mt-3">{{ message }}</div>
</div>
